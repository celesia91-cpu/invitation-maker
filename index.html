<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Digital Invitation Maker</title>

  <!-- PWA / Mobile fullscreen meta (for viewer links) -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0f1021">

  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Pacifico&family=Shadows+Into+Light&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
   <!-- Authentication Modal -->
  <div id="authModal" class="auth-modal">
    <div class="auth-card">
      <h2>Welcome to Invitation Maker</h2>
      <p>Sign in to save your projects to the cloud, or continue working offline.</p>
    
      <form id="loginForm">
        <div class="form-group">
          <label for="loginEmail">Email address</label>
          <input type="email" id="loginEmail" name="loginEmail" placeholder="Email address" required>
        </div>
        <div class="form-group">
          <label for="loginPassword">Password</label>
          <input type="password" id="loginPassword" name="loginPassword" placeholder="Password" required>
        </div>
        <div class="form-group" style="display:flex;align-items:center;gap:8px;margin-top:8px;">
          <input type="checkbox" id="rememberMe" name="rememberMe">
          <label for="rememberMe" style="margin:0;">Remember me</label>
        </div>
        <button type="submit" class="btn primary" style="width: 100%; margin: 16px 0 8px;">
          Sign In
        </button>
      </form>
    
      <p style="margin-top: 16px; font-size: 12px; color: #94a3b8; text-align: center;">
        Don't have an account? Create one in your backend admin panel.
      </p>
    </div>
  </div>
  <header class="topbar" id="topbar">
    <div class="brand"> Celesia Animated Invitation</div>
    <div class="grow"></div>

    <!-- editor controls hidden in viewer via .edit-only -->
    <button id="undoBtn" class="iconbtn edit-only mb-hide-when-collapsed" aria-label="Undo" disabled>Undo</button>
    <button id="redoBtn" class="iconbtn edit-only mb-hide-when-collapsed" aria-label="Redo" disabled>Redo</button>

    <button id="prevSlideBtn" class="iconbtn edit-only mb-hide-when-collapsed" aria-label="Previous slide">◀</button>
    <span id="slideLabel" class="pill edit-only mb-hide-when-collapsed">Slide 1/1</span>
    <button id="nextSlideBtn" class="iconbtn edit-only mb-hide-when-collapsed" aria-label="Next slide">▶</button>
    <button id="playSlidesBtn" class="iconbtn edit-only mb-hide-when-collapsed" aria-pressed="false">Play</button>

    <button id="previewBtn" class="iconbtn edit-only mb-hide-when-collapsed" aria-pressed="false">Preview</button>
    <button id="togglePanelBtn" class="iconbtn edit-only mb-hide-when-collapsed" aria-expanded="false">Panel</button>

    <!-- Share stays (we hide whole topbar in viewer anyway for fullscreen) -->
    <button id="shareBtn" class="iconbtn">Share</button>
  </header>

  <!-- Mobile topbar toggle (hidden in viewer) -->
  <button id="topbarToggle" class="iconbtn" aria-expanded="true" aria-label="Collapse top bar">▴</button>

  <!-- Fullscreen prompt (only used in viewer, appears if auto-FS is blocked) -->
  <div id="fsOverlay" class="fs-overlay" role="dialog" aria-modal="true" aria-labelledby="fsTitle" aria-hidden="true">
    <div class="fs-card">
      <h2 id="fsTitle">Tap to view full-screen</h2>
      <p>For the best experience, we'll hide the browser bar.</p>
      <button id="fsEnterBtn" class="fs-btn" type="button">Enter Full-Screen</button>
    </div>
  </div>

  <!-- Rotate device prompt -->
  <div id="rotateOverlay" class="rotate-overlay" aria-hidden="true">
    <div class="fs-card">
      <h2>Please rotate your device</h2>
    </div>
  </div>

  <div class="backdrop" id="backdrop"></div>

  <!-- Side Panel -->
  <aside class="sidepanel" id="sidepanel" aria-label="Design panel">
    <div class="panel-header">
      <div class="panel-controls">
        <button id="collapseAllBtn" class="btn" type="button">Collapse All</button>
        <button id="expandAllBtn" class="btn" type="button">Expand All</button>
      </div>
    </div>
    <div class="panel-body">
      <!-- Slides -->
      <section class="group" data-group="slides" aria-label="Slides">
        <div class="group-title" role="button" tabindex="0"><span class="chevron" aria-hidden="true">▾</span> Slides</div>
        <div class="group-content">
          <div class="row">
            <label>All slides</label>
            <div id="slidesStrip" class="slides-strip" role="tablist" aria-label="Slides"></div>
          </div>
          <div class="row" style="gap:8px">
            <label>Actions</label>
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button id="addSlideBtn" class="btn" type="button">Add</button>
              <button id="dupSlideBtn" class="btn" type="button">Duplicate</button>
              <button id="delSlideBtn" class="btn" type="button">Delete</button>
            </div>
          </div>
          <div class="row">
            <label for="slideDur">Duration <small id="slideDurVal">3.0s</small></label>
            <input id="slideDur" type="range" min="1000" max="10000" step="500" value="3000">
          </div>
        </div>
      </section>

      <!-- Text -->
      <section class="group" data-group="text" aria-label="Text">
        <div class="group-title" role="button" tabindex="0"><span class="chevron" aria-hidden="true">▾</span> Text</div>
        <div class="group-content">
          <div class="row">
            <label for="addText">Add Text</label>
            <div style="display:flex;gap:8px;width:100%;min-width:0">
              <input id="addText" type="text" placeholder="Type and press +">
              <button id="addTextBtn" class="btn">+</button>
            </div>
          </div>
          <div class="row" style="gap:8px">
            <label>Selected</label>
            <div style="display:flex;gap:8px;width:100%;flex-wrap:wrap;min-width:0">
              <button id="textDelete" class="btn" type="button" disabled>Delete text</button>
            </div>
          </div>
          <div class="row">
            <label>Fade In</label>
            <div style="display:flex;gap:8px;align-items:center;width:100%;flex-wrap:wrap">
              <button id="textFadeInBtn" class="btn toggle" type="button">Fade In</button>
              <input id="textFadeInRange" type="range" min="0" max="5000" step="100" value="0" style="flex:1 1 200px">
              <span id="textFadeInVal" class="pill">0.0s</span>
            </div>
          </div>
          <div class="row">
            <label>Fade Out</label>
            <div style="display:flex;gap:8px;align-items:center;width:100%;flex-wrap:wrap">
              <button id="textFadeOutBtn" class="btn toggle" type="button">Fade Out</button>
              <input id="textFadeOutRange" type="range" min="0" max="5000" step="100" value="0" style="flex:1 1 200px">
              <span id="textFadeOutVal" class="pill">0.0s</span>
            </div>
          </div>
          <div class="row">
            <label>Zoom In</label>
            <div style="display:flex;gap:8px;align-items:center;width:100%;flex-wrap:wrap">
              <button id="textZoomInBtn" class="btn toggle" type="button">Zoom In</button>
              <input id="textZoomInRange" type="range" min="0" max="5000" step="100" value="0" style="flex:1 1 200px">
              <span id="textZoomInVal" class="pill">0.0s</span>
            </div>
          </div>
          <div class="row">
            <label>Zoom Out</label>
            <div style="display:flex;gap:8px;align-items:center;width:100%;flex-wrap:wrap">
              <button id="textZoomOutBtn" class="btn toggle" type="button">Zoom Out</button>
              <input id="textZoomOutRange" type="range" min="0" max="5000" step="100" value="0" style="flex:1 1 200px">
              <span id="textZoomOutVal" class="pill">0.0s</span>
            </div>
          </div>
          <div class="row">
            <label for="textScale">Scale <small id="textScaleVal" aria-live="polite">100%</small></label>
            <input id="textScale" type="range" min="10" max="300" value="100">
          </div>
          <div class="row">
            <label for="textRotate">Rotate <small id="textRotateVal" aria-live="polite">0°</small></label>
            <input id="textRotate" type="range" min="-180" max="180" step="1" value="0">
          </div>
        </div>
      </section>

      <!-- Style -->
      <section class="group" data-group="style" aria-label="Style">
        <div class="group-title" role="button" tabindex="0"><span class="chevron" aria-hidden="true">▾</span> Style</div>
        <div class="group-content">
          <div class="row">
            <label for="fontSize">Font size</label>
            <input id="fontSize" type="range" min="10" max="96" value="28">
          </div>
          <div class="row">
            <label for="fontColor">Text color</label>
            <input id="fontColor" type="color" value="#ffffff">
          </div>
          <div class="row">
            <label for="fontFamily">Font family</label>
            <div class="chevron-select" style="width:100%">
              <select id="fontFamily">
                <option value="system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica Neue, Arial, sans-serif">System UI</option>
                <option value="Arial, Helvetica, sans-serif">Arial</option>
                <option value="Helvetica, Arial, sans-serif">Helvetica</option>
                <option value="Verdana, Geneva, sans-serif">Verdana</option>
                <option value="'Trebuchet MS', Tahoma, sans-serif">Trebuchet MS</option>
                <option value="'Times New Roman', Times, serif">Times New Roman</option>
                <option value="Georgia, 'Times New Roman', serif">Georgia</option>
                <option value="Garamond, 'Times New Roman', serif">Garamond</option>
                <option value="'Courier New', Courier, monospace">Courier New</option>
                <option value="Monaco, Consolas, 'Courier New', monospace">Monaco</option>
                <option value="'Pacifico', cursive">Pacifico</option>
                <option value="'Dancing Script', cursive">Dancing Script</option>
                <option value="'Shadows Into Light', cursive">Shadows Into Light</option>
              </select>
            </div>
          </div>
          <div class="row text-style-btns">
            <button id="boldBtn" title="Bold">B</button>
            <button id="italicBtn" title="Italic"><i>I</i></button>
            <button id="underlineBtn" title="Underline"><u>U</u></button>
          </div>
        </div>
      </section>

      <!-- Image -->
      <section class="group" data-group="image" aria-label="Image">
        <div class="group-title" role="button" tabindex="0"><span class="chevron" aria-hidden="true">▾</span> Image</div>
        <div class="group-content">
          <div class="row">
          <label for="imgScale">Scale <small id="imgScaleVal" aria-live="polite">100%</small></label>
          <input id="imgScale" type="range" min="10" max="300" value="100">
        </div>
        <div class="row">
          <label for="imgRotate">Rotate <small id="imgRotateVal" aria-live="polite">0°</small></label>
          <input id="imgRotate" type="range" min="-180" max="180" step="1" value="0">
        </div>
        <div class="row" style="gap:8px">
          <label>Actions</label>
          <div style="display:flex;gap:8px;width:100%;flex-wrap:wrap;min-width:0">
            <button id="imgFlip" class="btn" type="button">Flip</button>
            <button id="imgReplace" class="btn" type="button">Replace</button>
          </div>
        </div>

        <div class="row">
          <label>Fade In</label>
          <div style="display:flex;gap:8px;align-items:center;width:100%;flex-wrap:wrap">
            <button id="imgFadeInBtn" class="btn toggle" type="button">Fade In</button>
            <input id="imgFadeInRange" type="range" min="0" max="5000" step="100" value="0" style="flex:1 1 200px">
            <span id="imgFadeInVal" class="pill">0.0s</span>
          </div>
        </div>
        <div class="row">
          <label>Fade Out</label>
          <div style="display:flex;gap:8px;align-items:center;width:100%;flex-wrap:wrap">
            <button id="imgFadeOutBtn" class="btn toggle" type="button">Fade Out</button>
            <input id="imgFadeOutRange" type="range" min="0" max="5000" step="100" value="0" style="flex:1 1 200px">
            <span id="imgFadeOutVal" class="pill">0.0s</span>
          </div>
        </div>
        <div class="row">
          <label>Zoom In</label>
          <div style="display:flex;gap:8px;align-items:center;width:100%;flex-wrap:wrap">
            <button id="imgZoomInBtn" class="btn toggle" type="button">Zoom In</button>
            <input id="imgZoomInRange" type="range" min="0" max="5000" step="100" value="0" style="flex:1 1 200px">
            <span id="imgZoomInVal" class="pill">0.0s</span>
          </div>
        </div>
        <div class="row">
          <label>Zoom Out</label>
          <div style="display:flex;gap:8px;align-items:center;width:100%;flex-wrap:wrap">
            <button id="imgZoomOutBtn" class="btn toggle" type="button">Zoom Out</button>
            <input id="imgZoomOutRange" type="range" min="0" max="5000" step="100" value="0" style="flex:1 1 200px">
            <span id="imgZoomOutVal" class="pill">0.0s</span>
          </div>
        </div>
        </div>
      </section>

      <!-- Presets -->
      <section class="group" data-group="presets" aria-label="Presets">
        <div class="group-title" role="button" tabindex="0"><span class="chevron" aria-hidden="true">▾</span> Presets</div>
        <div class="group-content">
          <div class="row">
            <label>Choose</label>
            <div class="preset-grid" id="presetGrid" role="group" aria-label="Image filter presets">
            <button class="preset-btn" data-preset="none" aria-pressed="true"><span class="preset-icon" aria-hidden="true"></span><span class="preset-label">None</span></button>
            <button class="preset-btn" data-preset="warm" aria-pressed="false"><span class="preset-icon" aria-hidden="true"></span><span class="preset-label">Warm</span></button>
            <button class="preset-btn" data-preset="cool" aria-pressed="false"><span class="preset-icon" aria-hidden="true"></span><span class="preset-label">Cool</span></button>
            <button class="preset-btn" data-preset="mono" aria-pressed="false"><span class="preset-icon" aria-hidden="true"></span><span class="preset-label">Mono</span></button>
            <button class="preset-btn" data-preset="vintage" aria-pressed="false"><span class="preset-icon" aria-hidden="true"></span><span class="preset-label">Vintage</span></button>
            <button class="preset-btn" data-preset="dramatic" aria-pressed="false"><span class="preset-icon" aria-hidden="true"></span><span class="preset-label">Dramatic</span></button>
          </div>
        </div>
        </div>
      </section>

      <!-- Event -->
      <section class="group" data-group="event" aria-label="Event" id="mapGroup">
        <div class="group-title" role="button" tabindex="0"><span class="chevron" aria-hidden="true">▾</span> Event</div>
        <div class="group-content">
          <div class="row">
            <label for="mapInput">Venue / Map</label>
            <div style="display:flex; gap:8px; width:100%; min-width:0; flex-wrap:wrap;">
              <input id="mapInput" type="text" placeholder="e.g., 123 Main St, Toronto">
              <div style="display:flex; gap:8px;">
                <button id="mapOpenBtn" class="btn">Open</button>
                <button id="mapCopyBtn" class="btn">Copy Link</button>
              </div>
            </div>
          </div>
          <p class="hint" style="margin:8px 0 0;color:#94a3b8;font-size:12px">Set the place guests should see when they tap "View Map".</p>
        </div>
      </section>
    </div>
  </aside>

  <main class="stage">
    <div class="wrap">
      <div id="work" aria-label="Invitation stage (16:9)">
        <div id="vGuide" class="guide v" aria-hidden="true"></div>
        <div id="hGuide" class="guide h" aria-hidden="true"></div>

        <div id="userBgWrap"><img id="userBg" alt=""></div>
        <video id="fxVideo" autoplay muted loop playsinline>
          <source src="./Comp 1.webm" type="video/webm">
        </video>

        <div id="bgBox" class="hidden" aria-label="Background image transform box">
          <div class="handle nw" data-handle="nw"></div>
          <div class="handle ne" data-handle="ne"></div>
          <div class="handle se" data-handle="se"></div>
          <div class="handle sw" data-handle="sw"></div>
          <div class="handle rotate" data-handle="rotate" title="Rotate"></div>
        </div>

        <div id="rsvpBar" class="rsvp" role="group" aria-label="RSVP">
          <button id="rsvpYes" class="rsvp-btn">Yes</button>
          <button id="rsvpMaybe" class="rsvp-btn">Maybe</button>
          <button id="rsvpNo" class="rsvp-btn">No</button>
          <button id="rsvpMap" class="rsvp-btn primary">View Map</button>
        </div>

        <button id="uploadBgBtn">Upload Background</button>
        <input type="file" id="bgFileInput" accept="image/*">
      </div>
    </div>
  </main>

  <script type="module" src="/main.js"></script>
</body>
</html>
