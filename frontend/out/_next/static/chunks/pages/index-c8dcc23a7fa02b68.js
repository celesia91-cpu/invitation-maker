(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5728:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5891)}])},5891:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var a=n(5893),l=n(7294),i=n(1163),r=n(2281),s=n(6177),c=n(4197);let o={admin:[{key:"marketplace",href:"/",label:"Marketplace"},{key:"admin-dashboard",href:"/admin/dashboard",label:"Admin Dashboard"}],creator:[{key:"marketplace",href:"/",label:"Marketplace"},{key:"editor",href:"/editor",label:"Editor"}]};function d(e){let t=new Set,n=[];for(let l of e){var a;if(!l||"string"!=typeof l.href)continue;let e=l.href.trim();!e||t.has(e)||(t.add(e),n.push({key:null!==(a=l.key)&&void 0!==a?a:e,href:e,label:"string"==typeof l.label&&l.label.trim()?l.label:e}))}return n}function u(){let e=(0,i.useRouter)(),{navigationHistory:t,userRole:n}=(0,s.mr)(),r=(0,l.useMemo)(()=>{if(Array.isArray(t)&&t.length>0)return t;let n=(null==e?void 0:e.asPath)||(null==e?void 0:e.pathname)||"/";return[{href:n,label:(0,s.qD)(n)}]},[t,null==e?void 0:e.asPath,null==e?void 0:e.pathname]),u=(0,l.useMemo)(()=>(function(e){let t=(0,c.NP)(e);return"admin"===t?d(o.admin):"creator"===t?d(o.creator):d(o.creator.slice(0,1))})(n),[n]),p=(0,l.useMemo)(()=>{let e=[],t=new Set,n=n=>{if(!n||"string"!=typeof n.href)return;let a=n.href.trim();!a||t.has(a)||(t.add(a),e.push({href:a,label:"string"==typeof n.label&&n.label.trim()?n.label:(0,s.qD)(a)}))};return u.forEach(n),r.forEach(n),e},[r,u]);return(0,a.jsx)("nav",{id:"breadcrumbs",className:"breadcrumbs","aria-label":"Breadcrumb",children:(0,a.jsx)("ol",{children:p.map((e,t)=>{let n=t===p.length-1;return(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:e.href,"aria-current":n?"page":void 0,children:e.label})},"".concat(e.href,"-").concat(t))})})})}function p(e){let{designId:t,isOwned:n}=e,l=null==t?null:("string"==typeof t?t.trim():String(t))||null;return(0,a.jsxs)("section",{className:"admin-preview-actions","aria-label":"Admin preview controls","data-testid":"admin-preview-actions",children:[(0,a.jsx)("h3",{className:"admin-preview-heading",children:"Admin Controls"}),(0,a.jsxs)("p",{className:"admin-preview-metadata",children:["Design ID: ",(0,a.jsx)("code",{children:null!=l?l:"unassigned"})]}),(0,a.jsx)("p",{className:"admin-preview-status",children:n?"This design is already assigned to your managed library.":"This design is not yet assigned. You can feature or flag it below."}),(0,a.jsxs)("div",{className:"admin-preview-buttons",children:[(0,a.jsx)("button",{type:"button",className:"btn",disabled:!l,children:"Mark as Featured"}),(0,a.jsx)("button",{type:"button",className:"btn",disabled:!l,children:"Flag for Review"})]})]})}var m=n(3012),h=n(6145);function f(e){let{isOpen:t,designId:n,onClose:i,onUseDesign:r}=e,c=(0,h.Z)(t,i),{userRole:o}=(0,s.mr)(),{currentDesignId:d,setCurrentDesignId:u,ensureOwnership:f,isDesignOwned:g,loading:b,error:v}=(0,m.Z)(),y=(0,l.useMemo)(()=>{let e=void 0!==n?n:d;return null==e?null:"string"==typeof e?e:String(e)},[d,n]);if((0,l.useEffect)(()=>{t&&y&&(u(y),f(y).catch(()=>{}))},[f,t,y,u]),!t)return null;let x=!!y&&g(y),k="string"!=typeof o?"":o.trim().toLowerCase(),j=x?"Edit This Design":"Use This Design",N=b?"Checking ownership status…":x?"You already own this design.":v?"Unable to verify ownership. You may need to purchase this design.":"Preview this design before deciding to use it.";return(0,a.jsx)("div",{id:"previewModal",className:"preview-modal",role:"dialog","aria-modal":"true",ref:c,children:(0,a.jsxs)("div",{className:"preview-content",children:[(0,a.jsx)("button",{id:"previewClose",className:"iconbtn preview-close","aria-label":"Close preview",onClick:i,children:"\xd7"}),(0,a.jsx)("div",{id:"previewSlides",className:"preview-slides"}),(0,a.jsx)("p",{id:"previewStatus",className:"preview-status","aria-live":"polite",children:N}),(0,a.jsxs)("div",{className:"preview-actions",children:[(0,a.jsx)("button",{id:"useDesignBtn",className:"btn primary",onClick:()=>{null==r||r({designId:y,owned:x})},disabled:!y,children:j}),(0,a.jsx)("button",{id:"favoriteDesignBtn",className:"btn",children:"Favorite"})]}),"admin"===k&&(0,a.jsx)(p,{designId:y,isOwned:x})]})})}function g(e){let{isOpen:t,designId:n,onConfirm:i,onCancel:r}=e,s=(0,h.Z)(t,r),{currentDesignId:c,setCurrentDesignId:o,isDesignOwned:d,markDesignOwned:u,loading:p,error:f}=(0,m.Z)(),[g,b]=(0,l.useState)(!1),v=(0,l.useMemo)(()=>{let e=void 0!==n?n:c;return null==e?null:"string"==typeof e?e:String(e)},[c,n]);if((0,l.useEffect)(()=>{if(!t){b(!1);return}v&&o(v)},[t,v,o]),!t)return null;let y=!!v&&d(v),x=y?"You already own this design. Start editing when you are ready.":"You need tokens to edit this design.",k=f&&!y?"We were unable to verify your ownership status. Please try again later.":x,j=y?"Start Editing":"Confirm Purchase",N=async()=>{if(!g){b(!0);try{let e=y;!e&&v&&(u(v,{owned:!0,purchasedAt:new Date().toISOString()}),e=!0),null==i||i({designId:v,owned:e})}finally{b(!1)}}};return(0,a.jsx)("div",{id:"purchaseModal",className:"purchase-modal",role:"dialog","aria-modal":"true",ref:s,children:(0,a.jsxs)("div",{className:"purchase-content",children:[(0,a.jsx)("p",{id:"purchaseMessage","aria-live":"polite",children:k}),(0,a.jsxs)("div",{className:"purchase-actions",children:[(0,a.jsx)("button",{id:"purchaseConfirm",className:"btn primary",onClick:N,disabled:p||g||!v,children:j}),(0,a.jsx)("button",{id:"purchaseCancel",className:"btn",onClick:()=>{g||null==r||r()},disabled:g,children:"Cancel"})]})]})})}function b(e){return!Number.isFinite(e)||e<0?null:"".concat(Math.round(100*e),"%")}function v(e){let t,{listings:n,isLoading:i=!1,errorMessage:r=""}=e,s=(0,l.useMemo)(()=>{let e=Array.isArray(n)?n:[],t=0,a=0,l=0,i=null;return e.forEach((e,n)=>{var r;(r=null==e?void 0:e.flags)&&"object"==typeof r&&Object.values(r).some(e=>"boolean"==typeof e?e:null!=e&&""!==e)&&(t+=1);let s=function(e){let t=Number(e);return!Number.isFinite(t)||t<0?null:t}(null==e?void 0:e.conversionRate);null!==s&&(a+=s,l+=1,(!i||s>i.rate)&&(i={rate:s,title:function(e,t){let n="string"==typeof(null==e?void 0:e.title)?e.title.trim():"";if(n)return n;let a=null==e?void 0:e.id;return null!=a?"Design ".concat(String(a)):"Design ".concat(t+1)}(e,n),designer:function(e){var t;let n=null==e?void 0:null===(t=e.designer)||void 0===t?void 0:t.displayName;return"string"!=typeof n?"":n.trim()}(e)}))}),{totalListings:e.length,flaggedCount:t,averageConversionRate:l>0?a/l:null,topPerformer:i}},[n]);if(i)t=(0,a.jsx)("p",{className:"admin-marketplace-status","aria-live":"polite",children:"Loading admin analytics…"});else if(r)t=(0,a.jsx)("p",{className:"admin-marketplace-error",role:"alert",children:r});else if(0===s.totalListings)t=(0,a.jsx)("p",{className:"admin-marketplace-empty",children:"No analytics available yet. Listings will appear here once loaded."});else{let e=b(s.averageConversionRate),n=s.topPerformer;t=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("dl",{className:"admin-marketplace-metrics",children:[(0,a.jsxs)("div",{className:"admin-marketplace-metric",children:[(0,a.jsx)("dt",{children:"Total Listings"}),(0,a.jsx)("dd",{children:s.totalListings})]}),(0,a.jsxs)("div",{className:"admin-marketplace-metric",children:[(0,a.jsx)("dt",{children:"Listings With Flags"}),(0,a.jsx)("dd",{children:s.flaggedCount})]}),(0,a.jsxs)("div",{className:"admin-marketplace-metric",children:[(0,a.jsx)("dt",{children:"Average Conversion Rate"}),(0,a.jsx)("dd",{children:null!=e?e:"Not enough data"})]})]}),(0,a.jsx)("p",{className:"admin-marketplace-top-performer",children:n?(0,a.jsxs)(a.Fragment,{children:["Top performer: ",(0,a.jsx)("strong",{children:n.title}),n.designer?" by ".concat(n.designer):""," (",b(n.rate),")"]}):"Conversion metrics have not been collected for these listings yet."}),(0,a.jsx)("button",{type:"button",className:"btn admin-marketplace-manage","aria-label":"Open listing controls",children:"Open listing controls"})]})}return(0,a.jsxs)("section",{className:"admin-marketplace-analytics","aria-label":"Admin marketplace analytics","data-testid":"admin-marketplace-analytics",children:[(0,a.jsx)("h3",{className:"admin-marketplace-heading",children:"Admin Insights"}),t]})}function y(e){return"function"==typeof e}function x(e){let{listingId:t,flagEntries:n,conversionRateLabel:l,isPublished:i=!1,onManage:r,onPublish:s,onDelete:c}=e,o=Array.isArray(n)?n.filter(e=>Array.isArray(e)&&e.length>=2):[],d="string"!=typeof l?null:l.trim()||null,u=function(e){if(null==e)return null;if("string"==typeof e)return e.trim()||null;try{let t=String(e);return t.trim()?t:null}catch(e){return null}}(t),p=o.length>0,m=!!(u&&y(r)),h=!!(u&&y(s)&&!i),f=!!(u&&y(c));return(0,a.jsxs)("div",{className:"admin-marketplace-card-extras","data-testid":"admin-marketplace-card-extras",children:[(0,a.jsx)("h4",{className:"admin-marketplace-card-heading",children:"Admin controls"}),(0,a.jsxs)("p",{className:"admin-marketplace-metadata",children:["Listing ID: ",(0,a.jsx)("code",{children:null!=u?u:"unassigned"})]}),(0,a.jsxs)("p",{className:"admin-marketplace-status",children:["Status: ",i?"Live":"Draft"]}),(0,a.jsx)("p",{className:"marketplace-conversion",children:d?"Conversion Rate: ".concat(d):"Conversion analytics pending."}),p?(0,a.jsx)("ul",{className:"marketplace-flags",children:o.map(e=>{let[t,n]=e;return(0,a.jsx)("li",{children:"".concat(t,": ").concat(String(n))},t)})}):(0,a.jsx)("p",{className:"admin-marketplace-no-flags",children:"No active flags for this listing."}),(0,a.jsxs)("div",{className:"admin-marketplace-actions",children:[(0,a.jsx)("button",{type:"button",className:"btn",disabled:!m,onClick:()=>{u&&y(r)&&r(u)},children:"Manage Listing"}),(0,a.jsx)("button",{type:"button",className:"btn",disabled:!h,onClick:()=>{u&&y(s)&&!i&&s(u)},children:i?"Published":"Publish Listing"}),(0,a.jsx)("button",{type:"button",className:"btn",disabled:!f,onClick:()=>{u&&y(c)&&c(u)},children:"Delete Listing"})]})]})}var k=n(2490);let j=[{id:"",label:"All"},{id:"popular",label:"Popular"},{id:"recent",label:"Recently Added"},{id:"favorites",label:"Favorites"},{id:"recently-viewed",label:"Recently Viewed"},{id:"Birthday",label:"Birthday"},{id:"Wedding",label:"Wedding"}];function N(e){if(null==e)return"";let t=String(e).trim().toLowerCase();return t?t.replace(/[^a-z0-9-]+/g,"-").replace(/^-+|-+$/g,""):""}let w=new Map([["user","consumer"]]);function C(e){return"string"!=typeof e?"":e.trim().toLowerCase()}let S="demo-marketplace-design",A=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!=typeof e)throw TypeError("withRoleGate expects a component function");let{allowedRoles:n=[],fallback:i}=t,r=new Set(Array.isArray(n)?n.map(C).filter(Boolean):[]),c=e.displayName||e.name||"Component";function o(t){let{userRole:n}=(0,s.mr)(),c=C(n);return r.size>0&&r.has(c)?(0,a.jsx)(e,{...t}):"function"==typeof i?(0,a.jsx)(i,{...t,userRole:n}):(0,l.isValidElement)(i)?"string"==typeof i.type?i:(0,l.cloneElement)(i,{...t,userRole:n}):null!=i?i:null}return o.displayName="withRoleGate(".concat(c,")"),o}(function(e){var t,n;let{isOpen:i,onSkipToEditor:r}=e,[s,c]=(0,l.useState)(j[0].id),[o,d]=(0,l.useState)(""),[u,p]=(0,l.useState)({}),[m,h]=(0,l.useState)({}),[f,g]=(0,l.useState)({}),b=(0,l.useRef)([]),y=(0,l.useRef)(!0);(0,l.useEffect)(()=>(y.current=!0,()=>{y.current=!1}),[]);let C=(0,k.Z)(),S=null==C?void 0:C.user,A=null!==(t=null==S?void 0:S.id)&&void 0!==t?t:null,M=null==C?void 0:C.api,E=function(e){let t="string"==typeof e?e.trim().toLowerCase():"";return t?w.get(t)||t:"consumer"}(null==S?void 0:S.role),L="admin"===E,D=(0,l.useMemo)(()=>(function(e){let t=N(null==e?void 0:e.id)||N(null==e?void 0:e.username)||N(null==e?void 0:e.email)||"admin";return"owned-by-".concat(t)})(S||{}),[null==S?void 0:S.email,null==S?void 0:S.id,null==S?void 0:S.username]),R=(0,l.useMemo)(()=>L?[...j,{id:D,label:"My Designs"}]:j,[D,L]),P=o.trim(),I=P.toLowerCase(),O="string"==typeof s?s.trim():"",T=O.toLowerCase(),B=L&&O===D,_=[E||"consumer",T||"",I||""].join("::");(0,l.useEffect)(()=>{0!==R.length&&(R.some(e=>e.id===s)||c(R[0].id))},[s,R]);let F=u[_],U=Array.isArray(null==F?void 0:F.data)?F.data:[],Z=!!m[_],Y=null!==(n=f[_])&&void 0!==n?n:null,z=E.charAt(0).toUpperCase()+E.slice(1);(0,l.useEffect)(()=>{let e=!1;if(!i||!M||"function"!=typeof M.listMarketplace||F)return;let t=B?void 0:T||void 0,n=P||void 0,a=B&&null!==A?String(A):void 0;return h(e=>({...e,[_]:!0})),g(e=>{if(!e[_])return e;let t={...e};return delete t[_],t}),(async()=>{try{let l={role:E,category:t,search:n};B&&(a&&(l.ownerId=a),l.mine=!0);let i=await M.listMarketplace(l);if(e||!y.current)return;let r={role:"string"==typeof(null==i?void 0:i.role)?i.role:E,data:Array.isArray(null==i?void 0:i.data)?i.data:[]};p(e=>({...e,[_]:r}))}catch(t){if(e||!y.current)return;g(e=>({...e,[_]:t}))}finally{if(!y.current)return;h(e=>{if(!e[_])return e;let t={...e};return delete t[_],t})}})(),()=>{e=!0}},[M,_,T,F,i,B,E,P,A]);let W=(e,t)=>{var n,a,l;if(0===R.length)return;let{key:i}=e;if("ArrowDown"===i||"ArrowUp"===i){e.preventDefault();let a=(t+("ArrowDown"===i?1:-1)+R.length)%R.length;c(R[a].id),null===(n=b.current[a])||void 0===n||n.focus()}else if("Home"===i)e.preventDefault(),c(R[0].id),null===(a=b.current[0])||void 0===a||a.focus();else if("End"===i){e.preventDefault();let t=R.length-1;c(R[t].id),null===(l=b.current[t])||void 0===l||l.focus()}},G=Y?"function"==typeof(null==M?void 0:M.handleError)?M.handleError(Y):Y.message||"Unable to load marketplace.":"",V=Y?G:"",q=(0,l.useCallback)((e,t)=>{if(!t||!M||"string"!=typeof e)return;let n=e.trim().toLowerCase();if(!n)return;let a={manage:"manageMarketplaceListing",publish:"publishMarketplaceListing",delete:"deleteMarketplaceListing"}[n],l=a&&"function"==typeof M[a]?M[a]:null;return l?l.call(M,t):"function"==typeof M.handleAdminMarketplaceAction?M.handleAdminMarketplaceAction({action:n,listingId:t}):void("undefined"!=typeof console&&"function"==typeof console.info&&console.info("[admin] ".concat(n," marketplace listing"),t))},[M]),H=(0,l.useCallback)(e=>q("manage",e),[q]),X=(0,l.useCallback)(e=>q("publish",e),[q]),K=(0,l.useCallback)(e=>q("delete",e),[q]);return(0,a.jsxs)("div",{id:"marketplacePage",className:"page".concat(i?"":" hidden"),children:[(0,a.jsx)("h2",{children:"Marketplace"}),(0,a.jsx)("a",{href:"#",id:"skipToEditor",className:"btn",style:{margin:"16px 0",display:"inline-block"},onClick:e=>{e.preventDefault(),null==r||r()},children:"Skip to blank editor"}),(0,a.jsxs)("div",{className:"marketplace-layout",children:[(0,a.jsxs)("aside",{className:"category-sidebar",children:[(0,a.jsx)("input",{type:"text",id:"designSearch",placeholder:"Search designs",value:o,onChange:e=>d(e.target.value)}),(0,a.jsx)("ul",{id:"categoryTabs",className:"category-tabs",role:"tablist","aria-orientation":"vertical",children:R.map((e,t)=>{let n=s===e.id;return(0,a.jsx)("li",{children:(0,a.jsx)("button",{ref:e=>{b.current[t]=e},type:"button",className:"category-tab".concat(n?" active":""),"data-category":e.id,role:"tab","aria-selected":n,tabIndex:n?0:-1,onClick:()=>c(e.id),onKeyDown:e=>W(e,t),children:e.label})},e.id||"all")})})]}),(0,a.jsxs)("div",{id:"designGrid",className:"marketplace-grid",children:[(0,a.jsxs)("div",{className:"marketplace-role-summary","aria-live":"polite",children:["Viewing as ",(0,a.jsx)("strong",{children:z})]}),L&&(0,a.jsx)(v,{listings:U,isLoading:Z,errorMessage:V}),Z&&(0,a.jsx)("div",{className:"marketplace-status",role:"status",children:"Loading marketplace…"}),Y&&(0,a.jsx)("div",{className:"marketplace-error",role:"alert",children:G}),!Z&&!Y&&0===U.length&&(0,a.jsx)("p",{className:"marketplace-empty",children:"No designs found for this selection."}),U.map((e,t)=>{var n;let l=(null==e?void 0:e.id)===void 0||(null==e?void 0:e.id)===null?null:String(e.id),i=null!=l?l:"item-".concat(t),r=function(e){var t;let n=null==e?void 0:null===(t=e.designer)||void 0===t?void 0:t.displayName;return"string"==typeof n?n:""}(e),s=(n=null==e?void 0:e.flags)&&"object"==typeof n?Object.entries(n).filter(e=>{let[,t]=e;return"boolean"==typeof t?t:null!=t&&""!==t}):[],c=function(e){let t=Number(e);return!Number.isFinite(t)||t<0?null:"".concat(Math.round(100*t),"%")}(null==e?void 0:e.conversionRate),o=function(e){if(!e||"object"!=typeof e)return!1;if("boolean"==typeof e.published)return e.published;if("boolean"==typeof e.isPublished)return e.isPublished;let t="string"==typeof e.status?e.status.trim().toLowerCase():"";return!!t&&(!!["published","active","live","available"].includes(t)||!["draft","pending","archived","disabled","inactive"].includes(t)&&t.includes("publish"))}(e),d=("string"==typeof(null==e?void 0:e.status)?e.status.trim():"").toLowerCase(),u=d?d.charAt(0).toUpperCase()+d.slice(1):null,p="marketplace-status-badge-".concat(i);return(0,a.jsxs)("article",{className:"marketplace-card","data-testid":"marketplace-card-".concat(i),children:[(0,a.jsxs)("h3",{className:"marketplace-card-title",children:[(0,a.jsx)("span",{className:"marketplace-card-title-text",children:(null==e?void 0:e.title)||"Design ".concat(i)}),L&&u?(0,a.jsx)("span",{className:"marketplace-status-badge status-".concat(d),"data-testid":p,"aria-label":"Status: ".concat(u),children:u}):null]}),r?(0,a.jsx)("p",{className:"marketplace-designer",children:r}):null,!L&&s.length>0&&(0,a.jsx)("ul",{className:"marketplace-flags",children:s.map(e=>{let[t,n]=e;return(0,a.jsx)("li",{children:"".concat(t,": ").concat(String(n))},t)})}),!L&&null!==c&&(0,a.jsx)("p",{className:"marketplace-conversion",children:"Conversion Rate: ".concat(c)}),L&&(0,a.jsx)(x,{listingId:l,flagEntries:s,conversionRateLabel:c,isPublished:o,onManage:H,onPublish:X,onDelete:K})]},i)})]})]})]})},{allowedRoles:["guest","user","consumer","creator","admin"],fallback:function(e){let{isOpen:t,userRole:n}=e,l="string"==typeof n&&n.trim()?n:"unknown";return(0,a.jsx)("div",{id:"marketplacePage",className:"page".concat(t?"":" hidden"),children:(0,a.jsxs)("div",{className:"forbidden-placeholder",role:"alert","data-testid":"marketplace-forbidden",children:["Marketplace access is unavailable for the “",l,"” role."]})})}});function M(){let e=(0,i.useRouter)(),t=(0,k.Z)(),{pushNavigationHistory:n}=(0,s.mr)(),{setCurrentDesignId:c,isDesignOwned:o,currentDesignId:d}=(0,m.Z)(),[p,h]=(0,l.useState)(!1),[b,v]=(0,l.useState)(!1),[y,x]=(0,l.useState)(!1),[j,N]=(0,l.useState)(S),[w,C]=(0,l.useState)(!1),[M,E]=(0,l.useState)(!1),[L,D]=(0,l.useState)("marketplace");(0,l.useEffect)(()=>{t.isInitialized&&h(!t.isAuthenticated)},[t.isAuthenticated,t.isInitialized]);let R=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!!t.allowBlank,a=void 0!==e?e:null!=j?j:d;if(n&&(null==a||""==="".concat(a).trim()))return N(null),c(null),null;let l=null==a||""==="".concat(a).trim()?S:a,i="".concat(l).trim();return i?(N(i),c(i),i):(N(null),c(null),null)},[j,d,c]);(0,l.useEffect)(()=>{t.isAuthenticated||R(S)},[t.isAuthenticated,R]);let P=(0,l.useCallback)(()=>R(void 0),[R]),I=(0,l.useCallback)(function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=R(t,n),l=a&&a.length>0?"/editor/".concat(encodeURIComponent(a)):"/editor";e.push(l)},[e,R]),O=(0,l.useCallback)(()=>{D("inline-experience"),C(!0),E(!0),"function"==typeof n&&n({href:"/inline-experience",label:"Inline Experience"})},[n]);(0,l.useEffect)(()=>{"marketplace"===L&&(C(!1),E(!1))},[L]);let T=(0,l.useCallback)(()=>{C(e=>!e)},[]),B=(0,l.useCallback)(()=>{v(!1),x(!1),C(!1),E(!1),D("marketplace"),"function"==typeof n&&n({href:"/",label:"Marketplace"}),e&&"function"==typeof e.push&&e.push("/")},[n,e]);return(0,l.useCallback)(()=>{let e=P();e&&o(e)?I(e):x(!0)},[P,o,I]),(0,a.jsxs)("div",{"data-testid":"marketplace-root","data-panel-open":w?"true":"false","data-topbar-visible":M?"true":"false",children:[(0,a.jsx)(r.Z,{isOpen:p,onClose:()=>h(!1)}),(0,a.jsx)(u,{}),(0,a.jsx)("div",{className:"marketplace-inline-actions",style:{margin:"16px 0"},children:(0,a.jsx)("button",{type:"button",className:"btn",onClick:O,"aria-controls":"inlineExperience",children:"Open inline experience"})}),M&&(0,a.jsxs)("div",{className:"inline-experience-topbar","data-testid":"inline-experience-topbar",role:"region","aria-label":"Inline experience controls",style:{display:"flex",gap:8,alignItems:"center",marginBottom:16},children:[(0,a.jsx)("button",{type:"button",className:"btn",onClick:B,children:"Back to Marketplace"}),(0,a.jsx)("button",{type:"button",className:"btn",onClick:T,"aria-pressed":w,children:w?"Hide Panel":"Show Panel"})]}),"marketplace"!==L&&(0,a.jsxs)("div",{id:"inlineExperience",className:"inline-experience","data-testid":"inline-experience","data-panel-open":w?"true":"false",style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:24},children:[(0,a.jsx)("p",{style:{marginBottom:12},children:"This inline experience represents an editor view. Use the controls above to return to the marketplace."}),(0,a.jsx)("div",{className:"inline-experience-panel","data-testid":"inline-experience-panel",style:{display:w?"block":"none",padding:12,background:"#f8fafc",borderRadius:8},children:"Panel content is visible while the panel is open."}),!w&&(0,a.jsx)("div",{className:"inline-experience-panel","data-testid":"inline-experience-panel-collapsed","aria-hidden":"true",style:{padding:12,borderRadius:8,border:"1px dashed #cbd5f5",color:"#475569"},children:"Panel content is hidden while the panel is collapsed."})]}),(0,a.jsx)(A,{isOpen:"marketplace"===L,onSkipToEditor:()=>I(null,{allowBlank:!0})}),(0,a.jsx)(f,{isOpen:b,designId:j,onClose:()=>v(!1),onUseDesign:e=>{let{designId:t,owned:n}=e,a=R(t);n?(v(!1),I(a)):(v(!1),x(!0))}}),(0,a.jsx)(g,{isOpen:y,designId:j,onConfirm:e=>{let{designId:t,owned:n}=e,a=R(t);x(!1),n&&I(a)},onCancel:()=>x(!1)})]})}}},function(e){e.O(0,[395,888,774,179],function(){return e(e.s=5728)}),_N_E=e.O()}]);